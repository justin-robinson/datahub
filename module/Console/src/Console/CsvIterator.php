<?php

namespace Console;

/**
 * Class FileIterator
 * @package Console
 */
class CsvIterator extends \SplFileObject {

    /**
     * @var bool
     */
    private $hasHeaderRow = true;

    public function __construct ( $file_name, $open_mode = "r", $use_include_path = false, $context = null ) {

        parent::__construct ( $file_name, $open_mode, $use_include_path, $context );

        $this->setFlags(\SplFileObject::READ_CSV);
    }

    /**
     * @param bool $hasHeaderRow
     */
    public function setHasHeaderRow ( $hasHeaderRow = true ) {
        $this->hasHeaderRow = $hasHeaderRow;
    }

    /**
     * @return bool
     */
    public function getHasHeaderRow () {
        return $this->hasHeaderRow;
    }

    /**
     *
     */
    public function rewind () {

        parent::rewind (); // TODO: Change the autogenerated stub

        // if we have a header row, skip to it on rewind
        if ( $this->getHasHeaderRow() ) {
            $this->seek(1);
        }
    }

    /**
     * @return array|string
     */
    public function getHeaderRow () {

        // remember where we are
        $originalLine = $this->getCurrentLine();

        // get header row
        $this->seek(0);
        $headerRow = $this->current();

        // go back where we started
        $this->seek((int)$originalLine);

        return $headerRow;
    }

}